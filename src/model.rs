/*
MIT License
Copyright (c) 2021 Germ√°n Molina
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/

use crate::daylight_coefficients::DCFactory;
use crate::solar_surface::SolarSurface;
use crate::PI;
use calendar::Date;
use communication_protocols::error_handling::ErrorHandling;
use communication_protocols::simulation_model::SimulationModel;
use matrix::Matrix;
use rendering::scene::{Scene, Wavelengths};
use simple_model::{SimpleModel, SimulationState, SimulationStateHeader};
use solar::ReinhartSky;
use solar::{PerezSky, SkyUnits, Solar};
use weather::Weather;

#[derive(Clone)]
struct SolarModelOptions {
    /// Number of points utilized to calculate the average incident solar
    /// irradiance over each fenestration or surface in W/m2.
    ///
    /// A larger number of points leads to more accurate results but, as usual,
    /// it has an impact on the time of the computation. Specifically,
    /// the time required for creating the model increases linearly with
    /// the number of points. The time required to process each timestep
    /// is not affected.    
    n_solar_irradiance_points: Option<usize>,

    /// Number of primary rays sent from each of the `n_solar_irradiance_points`
    /// when calculating the average incident solar irradiance over
    /// each surface or fenestration.
    ///
    /// A larger number of rays leads to more accurate results but, as usual,
    /// it has an impact on the time of the computation. Specifically,
    /// the time required for creating the model increases linearly with
    /// the number of points. The time required to process each timestep
    /// is not affected.
    solar_ambient_divitions: Option<usize>,

    /// The sky discretization scheme used for solar irradiance. A value
    /// of 1 leads to 145 sky patches + the ground.
    ///
    /// A larger number leads to more accurate results but, as usual,
    /// it has an impact on the time of the computation. Although
    /// the time required for creating the model is not greatly affected,
    /// the time required for processing each timestep can increase considerably.
    solar_sky_discretization: Option<usize>,

    /// A path to the front solar irradiance matrix file, for surfaces. If the file does not exist,
    /// it will be saved. If it does exist, it will be used to calculate solar radiation
    /// instead of calculating the value internally.
    front_surfaces_solar_irradiance_matrix: Option<String>,

    /// A path to the back solar irradiance matrix file, for surfaces. If the file does not exist,
    /// it will be saved. If it does exist, it will be used to calculate solar radiation
    /// instead of calculating the value internally.
    back_surfaces_solar_irradiance_matrix: Option<String>,

    /// A path to the front solar irradiance matrix file, for fenestration. If the file does not exist,
    /// it will be saved. If it does exist, it will be used to calculate solar radiation
    /// instead of calculating the value internally.
    front_fenestrations_solar_irradiance_matrix: Option<String>,

    /// A path to the back solar irradiance matrix file, for fenestration. If the file does not exist,
    /// it will be saved. If it does exist, it will be used to calculate solar radiation
    /// instead of calculating the value internally.
    back_fenestrations_solar_irradiance_matrix: Option<String>,
}

impl Default for SolarModelOptions {
    fn default() -> Self {
        Self {
            n_solar_irradiance_points: Some(1),
            solar_sky_discretization: Some(1),
            solar_ambient_divitions: Some(3000),
            front_surfaces_solar_irradiance_matrix: None,
            back_surfaces_solar_irradiance_matrix: None,
            front_fenestrations_solar_irradiance_matrix: None,
            back_fenestrations_solar_irradiance_matrix: None,
        }
    }
}

pub struct SolarModel {
    // /// The scene that makes up this model from a lighting point of view.
    // lighting_scene: Scene,

    // Workplanes
    /// The scene that makes up this model from a radiation point of view.
    solar_scene: Scene,

    surfaces: Vec<SolarSurface>,

    /// The Daylight Coefficients matrix for the front-side of the  surfaces in the scene
    front_surfaces_dc: Matrix,

    /// The Daylight Coefficients matrix for the back-side of the  surfaces in the scene
    back_surfaces_dc: Matrix,

    fenestrations: Vec<SolarSurface>,

    /// The Daylight Coefficients matrix for the front-side of the  fenestrations in the scene
    front_fenestrations_dc: Matrix,

    /// The Daylight Coefficients matrix for the back-side of the fenestrations in the scene
    back_fenestrations_dc: Matrix,

    /// The options for the model.
    options: SolarModelOptions,
}

impl ErrorHandling for SolarModel {
    fn module_name() -> &'static str {
        "Solar Model"
    }
}

impl SimulationModel for SolarModel {
    type Type = Self;

    fn new(
        model: &SimpleModel,
        state: &mut SimulationStateHeader,
        _n: usize,
    ) -> Result<Self::Type, String> {
        
        let options = SolarModelOptions{            
            solar_ambient_divitions : Some(3000),
            solar_sky_discretization : Some(1),
            front_surfaces_solar_irradiance_matrix : Some("./test_data/front_surfaces_dc.mtx".to_string()),
            back_surfaces_solar_irradiance_matrix : Some("./test_data/back_surfaces_dc.mtx".to_string()),
            .. SolarModelOptions::default()
        };

        /*
        // // Add ground
        let metal = PlasticMetal {
            color: Spectrum::gray(0.2),
            specularity : 0.0,
            roughness : 0.0,
        };

        let ground_mat = solar_scene.push_material(Material::Metal(metal));
        let mut the_loop = Loop3D::new();
        let l = 100.0;
        eprintln!("FLOOR IS NOT ON THE FLOOR");
        the_loop.push(Point3D::new(-l, -l, -4.0)).unwrap();
        the_loop.push(Point3D::new(l, -l, -4.0)).unwrap();
        the_loop.push(Point3D::new(l, l, -4.0)).unwrap();
        the_loop.push(Point3D::new(-l, l, -4.0)).unwrap();
        the_loop.close().unwrap();
        let polygon = Polygon3D::new(the_loop).unwrap();
        let triangles = Triangulation3D::from_polygon(&polygon)
            .unwrap()
            .get_trilist();
        for tri in triangles {
            solar_scene.push_object(ground_mat, ground_mat, Primitive::Triangle(tri));
        }
        */
        // let lighting_scene = Scene::from_simple_model(&model, Wavelengths::Visible);
        // lighting_scene.build_accelerator();

        /* *********************** */
        /* PROCESS SOLAR RADIATION */
        /* *********************** */
        let mut solar_scene = Scene::from_simple_model(model, Wavelengths::Solar);
        solar_scene.build_accelerator();
        let mf = options.solar_sky_discretization.unwrap();
        let n_solar_rays = options.n_solar_irradiance_points.unwrap();

        let solar_dc_factory = DCFactory {
            max_depth: 0,
            n_ambient_samples: options.solar_ambient_divitions.unwrap(),
            reinhart: ReinhartSky::new(mf),
            ..DCFactory::default()
        };

        // Create Surfaces
        let surfaces = SolarSurface::make_surfaces(&model.surfaces, state, n_solar_rays);
        let front_surfaces_dc = SolarSurface::get_front_solar_dc_matrix(
            &surfaces,
            &options.front_surfaces_solar_irradiance_matrix,
            &solar_scene,
            &solar_dc_factory,
        )?;
        let back_surfaces_dc = SolarSurface::get_back_solar_dc_matrix(
            &surfaces,
            &options.back_surfaces_solar_irradiance_matrix,
            &solar_scene,
            &solar_dc_factory,
        )?;

        // Process Fenestrations
        let fenestrations =
            SolarSurface::make_fenestrations(&model.fenestrations, state, n_solar_rays);
        let front_fenestrations_dc = SolarSurface::get_front_solar_dc_matrix(
            &fenestrations,
            &options.front_fenestrations_solar_irradiance_matrix,
            &solar_scene,
            &solar_dc_factory,
        )?;
        let back_fenestrations_dc = SolarSurface::get_back_solar_dc_matrix(
            &fenestrations,
            &options.back_fenestrations_solar_irradiance_matrix,
            &solar_scene,
            &solar_dc_factory,
        )?;

        Ok(Self {
            options,
            solar_scene,
            surfaces,
            front_surfaces_dc,
            back_surfaces_dc,
            fenestrations,
            front_fenestrations_dc,
            back_fenestrations_dc,
        })
    }

    fn march(
        &self,
        date: Date,
        weather: &dyn Weather,
        model: &SimpleModel,
        state: &mut SimulationState,
    ) -> Result<(), String> {
        // Handle the solar part
        let lat = -33.38 * PI / 180.;
        let lon = 70.78 * PI / 180.;
        let std_mer = 60. * PI / 180.;

        let solar = Solar::new(lat, lon, std_mer);

        let weather_data = weather.get_weather_data(date);

        // Build sky vector
        let albedo = 0.2;
        let add_sky = true;
        let add_sun = true;
        let units = SkyUnits::Solar;
        let vec = PerezSky::gen_sky_vec(
            self.options.solar_sky_discretization.unwrap(),
            &solar,
            date,
            weather_data,
            units,
            albedo,
            add_sky,
            add_sun,
        )
        .unwrap();

        // Process Solar Irradiance in Surfaces
        let solar_irradiance = &self.front_surfaces_dc * &vec;
        for (i, s) in model.surfaces.iter().enumerate() {
            let v = solar_irradiance.get(i, 0).unwrap();
            s.set_front_incident_solar_irradiance(state, v);
        }
        let solar_irradiance = &self.back_surfaces_dc * &vec;
        for (i, s) in model.surfaces.iter().enumerate() {
            let v = solar_irradiance.get(i, 0).unwrap();
            s.set_back_incident_solar_irradiance(state, v);
        }

        // Process Solar Irradiance in Fenestration
        let solar_irradiance = &self.front_fenestrations_dc * &vec;
        for (i, s) in model.fenestrations.iter().enumerate() {
            let v = solar_irradiance.get(i, 0).unwrap();
            s.set_front_incident_solar_irradiance(state, v);
        }
        let solar_irradiance = &self.back_fenestrations_dc * &vec;
        for (i, s) in model.fenestrations.iter().enumerate() {
            let v = solar_irradiance.get(i, 0).unwrap();
            s.set_back_incident_solar_irradiance(state, v);
        }

        // return
        Ok(())
        // unimplemented!()
    }
}

/***********/
/* TESTING */
/***********/

#[cfg(test)]
mod tests {

    use super::*;
    use crate::Float;
    use schedule::ScheduleConstant;
    use simple_test_models::*;
    use solar::Time;
    use weather::SyntheticWeather;

    #[test]
    fn it_works() {
        let incident_solar_radiation = [
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            22.10646184,
            26.52037076,
            30.33829044,
            33.79710130,
            37.04109062,
            40.15278299,
            43.17905067,
            46.14675988,
            49.07144879,
            51.19563413,
            52.14290011,
            53.29763049,
            54.60341139,
            56.02013467,
            57.51850948,
            59.07665290,
            60.67789384,
            68.25726950,
            83.81988936,
            90.92365164,
            97.80406506,
            104.46817846,
            110.92196916,
            117.17054514,
            123.21830720,
            129.06907951,
            134.83617675,
            148.72356897,
            153.93420568,
            158.95443680,
            163.78603711,
            168.43066209,
            172.88987384,
            177.16516255,
            181.25796418,
            185.16967522,
            188.90166504,
            190.44027874,
            191.85942187,
            193.15613074,
            194.32795866,
            195.37291154,
            203.91891758,
            204.61891625,
            205.16582491,
            205.56146725,
            205.80761819,
            205.90602062,
            205.85839916,
            205.66647165,
            205.33195858,
            204.85659096,
            204.24211687,
            203.49030686,
            202.60295838,
            201.58189951,
            200.42899200,
            197.93774987,
            200.19598775,
            197.44138075,
            194.61992859,
            191.73396061,
            188.78573340,
            185.77744128,
            182.71122544,
            179.58918199,
            176.41336904,
            173.18581289,
            169.90851357,
            166.58344960,
            163.21258231,
            159.79785958,
            156.34121917,
            152.84459163,
            149.30990292,
            145.73907670,
            145.97194049,
            146.13855212,
            146.30793020,
            146.48000509,
            146.65469839,
            146.83192360,
            147.01158667,
            147.19358657,
            147.37781580,
            147.56416092,
            147.75250304,
            152.40605388,
            152.52694955,
            152.64886990,
            152.77173962,
            152.89547830,
            153.02000109,
            153.14521931,
            153.27104110,
            153.39737209,
            153.52411601,
            153.02832911,
            152.53673955,
            152.04936794,
            151.56622827,
            151.08732863,
            150.61267198,
            150.14225691,
            150.38910672,
            150.12390348,
            149.85243731,
            149.57511197,
            149.29231584,
            149.00442363,
            148.71179812,
            148.41479194,
            148.11374943,
            147.80900841,
            147.50090217,
            147.18976138,
            146.87591617,
            146.95961376,
            147.03040108,
            147.08880358,
            147.13541550,
            147.17090804,
            147.19603827,
            147.21165879,
            147.21872809,
            147.21832134,
            147.21164144,
            147.20002965,
            147.18497536,
            147.16812382,
            147.15128070,
            147.13641183,
            147.12563622,
            147.12121008,
            147.12549989,
            147.14094233,
            147.16999019,
            147.02496009,
            146.89979494,
            146.79619967,
            146.71555349,
            146.65883821,
            146.62658429,
            146.61884169,
            146.63517927,
            146.67471283,
            146.73615793,
            146.81790071,
            146.91807853,
            147.03466207,
            147.16553244,
            147.30854825,
            147.46160046,
            147.62265410,
            147.78977781,
            147.96116267,
            148.13513218,
            148.38022739,
            148.62913154,
            148.88080937,
            149.13430685,
            149.38874676,
            149.64332326,
            149.89729593,
            150.14998368,
            150.40075870,
            150.64904066,
            150.89429116,
            151.13600865,
            151.37372358,
            151.60699407,
            151.83540186,
            152.05854859,
            152.27605248,
            152.81376150,
            153.12561597,
            153.43617948,
            152.91801629,
            152.38479491,
            151.83645122,
            151.27294047,
            150.69423544,
            150.10032469,
            149.49121114,
            148.86691070,
            148.22745109,
            147.57287076,
            146.90321796,
            146.21854987,
            145.51893179,
            144.80443651,
            144.07514361,
            143.33113892,
            142.57251400,
            141.79936565,
            141.01179550,
            140.20990960,
            139.81237053,
            139.41645201,
            139.02231086,
            138.63009901,
            138.23996296,
            137.85204337,
            137.46647450,
            137.08338372,
            136.70289098,
            136.32510826,
            135.95013896,
            135.57807730,
            134.54194697,
            138.77681406,
            143.00254432,
            147.21735673,
            151.41944153,
            155.60695532,
            159.77801560,
            163.93069461,
            167.07959490,
            170.16187426,
            173.17546450,
            176.11829608,
            178.98829450,
            181.78337611,
            184.50144338,
            187.14037933,
            189.69804124,
            192.17225337,
            194.56079848,
            196.86140822,
            199.07175191,
            201.18942358,
            203.21192704,
            205.13665849,
            201.38946838,
            203.03487284,
            204.59261842,
            206.06146465,
            205.32773213,
            204.41030375,
            203.30761192,
            202.01814515,
            200.54044395,
            198.87309566,
            197.01472779,
            194.96399956,
            192.71959123,
            190.28019049,
            178.83168243,
            175.94809029,
            172.89364914,
            169.67095124,
            166.28317387,
            162.73417381,
            159.02860269,
            155.17204922,
            151.17121533,
            138.61328325,
            134.44108107,
            129.98624010,
            125.50139638,
            120.86380121,
            116.06902341,
            111.11194598,
            105.98662062,
            100.68608844,
            95.20215877,
            89.52513638,
            83.64348630,
            77.54342589,
            71.20843781,
            64.61871138,
            57.75055459,
            42.39370004,
            34.94249822,
            27.16532184,
            18.83913944,
            9.33338590,
            8.87520948,
            8.50088377,
            8.60399710,
            8.79584231,
            9.08482304,
            9.45721446,
            9.82720772,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            20.12198201,
            24.64408842,
            28.52139290,
            32.00008240,
            35.23848406,
            38.32905220,
            41.32483783,
            44.25648352,
            47.14187417,
            49.72669210,
            50.61461959,
            51.71679678,
            52.97478834,
            54.34729050,
            55.80428294,
            57.32342693,
            58.88776130,
            66.50903168,
            82.08106092,
            89.21951225,
            96.13165442,
            102.82505117,
            109.30611375,
            115.58031672,
            121.65237145,
            127.52636595,
            133.31978678,
            147.20221714,
            152.43559962,
            157.47840283,
            162.33249901,
            166.99962651,
            171.48141808,
            175.77942416,
            179.89513211,
            183.82998226,
            187.58538127,
            189.14353932,
            190.58108254,
            191.89469696,
            193.08163820,
            194.13965918,
            202.69813075,
            203.41122734,
            203.96706341,
            204.36762343,
            204.61482349,
            204.71053133,
            204.65658298,
            204.45479645,
            204.10698320,
            203.61495764,
            202.98054497,
            202.20558780,
            201.29195158,
            200.24152909,
            199.05624419,
            201.04841486,
            197.90500558,
            194.68383790,
            191.38855729,
            188.02260006,
            184.58922010,
            181.09151225,
            177.53243285,
            173.91481774,
            170.24139807,
            166.51481429,
            162.73762832,
            158.91233445,
            155.04136883,
            151.12711792,
            147.17192590,
            143.17810125,
            139.14792257,
            135.08364369,
            134.99661105,
            135.87624128,
            136.74783585,
            137.61124265,
            143.23755894,
            144.03650452,
            144.82536476,
            145.60400097,
            146.37227533,
            147.13005114,
            147.87719318,
            148.61356804,
            149.33904447,
            150.05349373,
            150.75679003,
            151.44881093,
            152.12943782,
            152.79855641,
            153.45605725,
            154.10183636,
            154.73579584,
            154.38705664,
            154.03973462,
            153.69384558,
            153.34940257,
            153.00641659,
            152.66489744,
            152.32485455,
            151.98629784,
            151.64923866,
            151.31369076,
            150.97967131,
            150.93991232,
            150.74608655,
            150.54728808,
            150.34386108,
            150.13615227,
            149.92451334,
            149.70930354,
            149.49089242,
            149.26966284,
            149.28657198,
            149.29148724,
            149.28498570,
            149.26771753,
            149.24041464,
            149.20390001,
            149.15909796,
            149.10704495,
            149.04890096,
            148.98596095,
            148.91966600,
            148.85161340,
            148.78356462,
            148.71744992,
            148.65536792,
            148.59957811,
            148.55248399,
            148.51660470,
            148.49453309,
            148.48887893,
            148.32608792,
            148.18619074,
            148.07103934,
            147.98214200,
            147.92058531,
            147.88697406,
            147.88139666,
            147.90342057,
            147.95211845,
            148.02612146,
            148.12369291,
            148.24281378,
            148.38127119,
            148.53674257,
            148.70686990,
            148.88932119,
            149.08183802,
            149.28226966,
            149.48859554,
            149.69893773,
            149.68604213,
            149.66803471,
            149.64333147,
            149.61051308,
            149.56831236,
            149.51560127,
            149.45137813,
            149.37475533,
            149.28494778,
            149.18126231,
            149.06308790,
            148.92988692,
            148.78118724,
            148.61657515,
            148.43568907,
            148.23821393,
            148.02387624,
            147.79243969,
            147.54370119,
            147.27748751,
            147.12527847,
            146.96617442,
            146.80007584,
            146.62689134,
            146.44653598,
            146.25892990,
            146.06399688,
            145.86166312,
            145.65185600,
            145.43450299,
            145.20953055,
            143.07222932,
            142.87400092,
            142.67213031,
            142.46670439,
            142.25781078,
            142.04553729,
            141.82997144,
            141.61120006,
            141.38930879,
            140.73981903,
            140.08621339,
            139.42866332,
            138.76733937,
            138.10241094,
            137.43404582,
            136.76240993,
            136.08766694,
            135.40997791,
            134.72950098,
            134.04639100,
            133.36079918,
            136.60406629,
            140.50608318,
            139.73047962,
            143.66375240,
            147.58798139,
            151.50174036,
            155.40359714,
            159.29211145,
            162.69935672,
            166.04058858,
            169.31356345,
            172.51602101,
            175.64567841,
            178.70022359,
            181.67730754,
            184.57453557,
            187.38945710,
            190.11955407,
            192.76222754,
            195.31478222,
            197.77440873,
            200.13816301,
            202.40294253,
            204.56545878,
            201.07623835,
            202.94265876,
            204.71830128,
            206.40163610,
            205.74006320,
            204.90760618,
            203.90285985,
            202.72448708,
            201.37121844,
            199.84185140,
            198.13524919,
            196.25033885,
            194.18610868,
            191.94160450,
            189.51592469,
            186.90821342,
            175.06617520,
            172.03723143,
            168.84724006,
            165.49857862,
            161.99416195,
            158.33753240,
            154.53297100,
            150.58563572,
            146.29273562,
            141.84788683,
            137.22578030,
            132.43753057,
            127.48013583,
            122.35012647,
            108.18370097,
            102.65397505,
            96.93806748,
            91.02834308,
            84.91568696,
            78.58915357,
            72.03553469,
            65.23883921,
            58.17969443,
            50.83472538,
            43.17608624,
            27.32210907,
            18.94151892,
            9.33210842,
            8.87376829,
            8.43318564,
            8.52394725,
            8.70129845,
            8.97403444,
            9.33084933,
            9.69406244,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            24.68201157,
            28.48486283,
            31.83544914,
            34.92455262,
            37.86050076,
            40.70343756,
            43.48691894,
            46.22983442,
            48.94282581,
            49.88341458,
            50.82685118,
            51.95180072,
            53.21011325,
            54.56714647,
            55.99735095,
            57.48148018,
            65.06922396,
            80.57549238,
            87.68000193,
            94.55849942,
            101.21881318,
            107.66756469,
            113.91039598,
            119.95215211,
            125.79702810,
            131.44868749,
            137.00932689,
            150.60140512,
            155.62129569,
            160.45400659,
            165.10129223,
            169.56479680,
            173.84607829,
            177.94662838,
            181.86788894,
            185.61126583,
            187.26823999,
            188.80465770,
            190.21750243,
            191.50428429,
            192.66297373,
            193.69194590,
            202.07596574,
            202.73798281,
            203.24718599,
            203.60533261,
            203.81414994,
            203.87534880,
            203.79063491,
            203.56171828,
            203.19032090,
            202.67818320,
            202.02706930,
            201.23877144,
            200.31511352,
            199.25795410,
            196.39605689,
            193.46771098,
            195.13615391,
            191.89977138,
            188.58862408,
            185.20620286,
            181.75581757,
            178.24062004,
            174.66362428,
            171.02772420,
            167.33570924,
            163.59027812,
            159.79405095,
            155.94957999,
            152.05935908,
            148.12583199,
            144.15139985,
            140.13842766,
            136.08925009,
            136.07441525,
            136.55420466,
            137.03225056,
            137.50843002,
            142.76600259,
            143.18042016,
            143.59170150,
            143.99975036,
            144.40446687,
            144.80574800,
            145.20348799,
            145.59757882,
            145.98791065,
            146.37437222,
            146.75685136,
            147.13523543,
            147.50941178,
            147.87926829,
            148.24469381,
            148.60557880,
            148.96181579,
            149.48634872,
            149.99324812,
            150.48253245,
            150.95423107,
            151.40838523,
            151.84504912,
            152.26429114,
            152.66619523,
            153.05086238,
            153.41841240,
            153.76898578,
            154.10274589,
            154.41988140,
            154.72060905,
            155.00517671,
            155.27386689,
            155.52700067,
            155.76494216,
            155.98810351,
            156.19695053,
            157.55759199,
            158.84857248,
            160.07145733,
            161.22796167,
            162.31997107,
            163.34956455,
            163.06039542,
            164.17251566,
            165.24070397,
            166.26767950,
            167.25645441,
            168.21036222,
            169.13308499,
            170.02867723,
            170.90158389,
            171.75664920,
            172.59911208,
            173.43458377,
            174.26900304,
            175.10856501,
            175.40893769,
            175.73305220,
            176.08666671,
            176.47521968,
            176.90366992,
            177.37635066,
            191.32199252,
            191.97285186,
            192.65048791,
            193.35562649,
            194.08845315,
            194.84867792,
            195.63561379,
            196.44826036,
            197.28538531,
            198.14559841,
            199.02741496,
            199.92930727,
            200.84974433,
            201.78722085,
            201.52770332,
            201.27873816,
            201.03850994,
            200.80538827,
            200.57791538,
            200.35479254,
            200.13486618,
            199.91711422,
            199.70063296,
            199.48462484,
            199.26838704,
            199.05130112,
            198.83282354,
            198.61247715,
            208.51821851,
            208.07789804,
            207.63417278,
            207.18688686,
            206.73590921,
            206.28113029,
            205.09391183,
            203.89909175,
            202.69675042,
            201.48698509,
            200.26990774,
            199.04564325,
            197.81432767,
            196.57610673,
            195.33113447,
            194.07957203,
            192.82158650,
            191.55734997,
            190.28703857,
            189.01083165,
            187.72891103,
            186.44146026,
            185.14866401,
            183.85070746,
            182.54777572,
            181.24005331,
            179.48795163,
            177.73281576,
            180.38783740,
            178.39644627,
            176.40538232,
            174.41496140,
            172.42549460,
            170.43728798,
            168.45064238,
            166.46585320,
            164.48321014,
            162.50299700,
            161.47607291,
            160.90987760,
            160.25862727,
            159.52119205,
            159.37456116,
            158.13946713,
            156.82016008,
            155.41581508,
            154.03542501,
            152.61631400,
            151.15813634,
            149.66055085,
            148.12322065,
            146.54581272,
            144.92799762,
            143.26944897,
            141.56984300,
            139.82885804,
            138.04617387,
            136.22147107,
            134.35443029,
            132.44473138,
            130.49205243,
            128.49606876,
            126.45645168,
            124.37286719,
            118.36616374,
            115.95663398,
            113.19958350,
            110.40586202,
            107.57462275,
            104.70496476,
            101.79592903,
            98.84649428,
            95.85557279,
            92.82200617,
            89.74456137,
            86.62192696,
            83.45271003,
            80.23543407,
            76.96853831,
            73.65037929,
            70.27923558,
            66.85331714,
            63.37078118,
            59.82975719,
            56.22838516,
            52.56487208,
            50.43324707,
            48.13477265,
            45.94487135,
            43.72999767,
            41.48781984,
            39.21570047,
            36.91066347,
            34.56936477,
            32.18807387,
            29.76267872,
            27.28873722,
            24.76161643,
            22.17679516,
            19.53046844,
            16.82071437,
            14.35092375,
            12.16644009,
            9.98793881,
            7.81685340,
            5.65526000,
            5.37462581,
            5.09464566,
            4.81541184,
            4.53702066,
            4.25952888,
            3.98281622,
            3.70619720,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
            0.00000000,
        ];
        let diffuse_horizontal_rad = [
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 14.60, 17.50, 20.40, 23.30, 26.20, 29.10, 32.00, 34.90, 37.80, 40.70, 43.60,
            46.50, 49.40, 52.30, 55.20, 58.10, 61.00, 65.70, 70.40, 75.10, 79.80, 84.50, 89.20,
            93.90, 98.60, 103.30, 108.00, 112.70, 117.40, 122.10, 126.80, 131.50, 136.20, 140.90,
            145.60, 150.30, 155.00, 156.00, 157.00, 158.00, 159.00, 160.00, 161.00, 162.00, 163.00,
            164.00, 165.00, 166.00, 167.00, 168.00, 169.00, 170.00, 171.00, 172.00, 173.00, 174.00,
            175.00, 175.70, 176.40, 177.10, 177.80, 178.50, 179.20, 179.90, 180.60, 181.30, 182.00,
            182.70, 183.40, 184.10, 184.80, 185.50, 186.20, 186.90, 187.60, 188.30, 189.00, 188.20,
            187.40, 186.60, 185.80, 185.00, 184.20, 183.40, 182.60, 181.80, 181.00, 180.20, 179.40,
            178.60, 177.80, 177.00, 176.20, 175.40, 174.60, 173.80, 173.00, 170.90, 168.80, 166.70,
            164.60, 162.50, 160.40, 158.30, 156.20, 154.10, 152.00, 149.90, 147.80, 145.70, 143.60,
            141.50, 139.40, 137.30, 135.20, 133.10, 131.00, 131.60, 132.20, 132.80, 133.40, 134.00,
            134.60, 135.20, 135.80, 136.40, 137.00, 137.60, 138.20, 138.80, 139.40, 140.00, 140.60,
            141.20, 141.80, 142.40, 143.00, 143.05, 143.10, 143.15, 143.20, 143.25, 143.30, 143.35,
            143.40, 143.45, 143.50, 143.55, 143.60, 143.65, 143.70, 143.75, 143.80, 143.85, 143.90,
            143.95, 144.00, 145.15, 146.30, 147.45, 148.60, 149.75, 150.90, 152.05, 153.20, 154.35,
            155.50, 156.65, 157.80, 158.95, 160.10, 161.25, 162.40, 163.55, 164.70, 165.85, 167.00,
            165.85, 164.70, 163.55, 162.40, 161.25, 160.10, 158.95, 157.80, 156.65, 155.50, 154.35,
            153.20, 152.05, 150.90, 149.75, 148.60, 147.45, 146.30, 145.15, 144.00, 144.55, 145.10,
            145.65, 146.20, 146.75, 147.30, 147.85, 148.40, 148.95, 149.50, 150.05, 150.60, 151.15,
            151.70, 152.25, 152.80, 153.35, 153.90, 154.45, 155.00, 154.40, 153.80, 153.20, 152.60,
            152.00, 151.40, 150.80, 150.20, 149.60, 149.00, 148.40, 147.80, 147.20, 146.60, 146.00,
            145.40, 144.80, 144.20, 143.60, 143.00, 141.70, 140.40, 139.10, 137.80, 136.50, 135.20,
            133.90, 132.60, 131.30, 130.00, 128.70, 127.40, 126.10, 124.80, 123.50, 122.20, 120.90,
            119.60, 118.30, 117.00, 112.05, 107.10, 102.15, 97.20, 92.25, 87.30, 82.35, 77.40,
            72.45, 67.50, 62.55, 57.60, 52.65, 47.70, 42.75, 37.80, 32.85, 27.90, 22.95, 18.00,
            17.10, 16.20, 15.30, 14.40, 13.50, 12.60, 11.70, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 13.60, 16.50, 19.40, 22.30, 25.20,
            28.10, 31.00, 33.90, 36.80, 39.70, 42.60, 45.50, 48.40, 51.30, 54.20, 57.10, 60.00,
            64.75, 69.50, 74.25, 79.00, 83.75, 88.50, 93.25, 98.00, 102.75, 107.50, 112.25, 117.00,
            121.75, 126.50, 131.25, 136.00, 140.75, 145.50, 150.25, 155.00, 155.80, 156.60, 157.40,
            158.20, 159.00, 159.80, 160.60, 161.40, 162.20, 163.00, 163.80, 164.60, 165.40, 166.20,
            167.00, 167.80, 168.60, 169.40, 170.20, 171.00, 170.40, 169.80, 169.20, 168.60, 168.00,
            167.40, 166.80, 166.20, 165.60, 165.00, 164.40, 163.80, 163.20, 162.60, 162.00, 161.40,
            160.80, 160.20, 159.60, 159.00, 159.95, 160.90, 161.85, 162.80, 163.75, 164.70, 165.65,
            166.60, 167.55, 168.50, 169.45, 170.40, 171.35, 172.30, 173.25, 174.20, 175.15, 176.10,
            177.05, 178.00, 176.45, 174.90, 173.35, 171.80, 170.25, 168.70, 167.15, 165.60, 164.05,
            162.50, 160.95, 159.40, 157.85, 156.30, 154.75, 153.20, 151.65, 150.10, 148.55, 147.00,
            147.55, 148.10, 148.65, 149.20, 149.75, 150.30, 150.85, 151.40, 151.95, 152.50, 153.05,
            153.60, 154.15, 154.70, 155.25, 155.80, 156.35, 156.90, 157.45, 158.00, 158.00, 158.00,
            158.00, 158.00, 158.00, 158.00, 158.00, 158.00, 158.00, 158.00, 158.00, 158.00, 158.00,
            158.00, 158.00, 158.00, 158.00, 158.00, 158.00, 158.00, 157.10, 156.20, 155.30, 154.40,
            153.50, 152.60, 151.70, 150.80, 149.90, 149.00, 148.10, 147.20, 146.30, 145.40, 144.50,
            143.60, 142.70, 141.80, 140.90, 140.00, 140.40, 140.80, 141.20, 141.60, 142.00, 142.40,
            142.80, 143.20, 143.60, 144.00, 144.40, 144.80, 145.20, 145.60, 146.00, 146.40, 146.80,
            147.20, 147.60, 148.00, 147.75, 147.50, 147.25, 147.00, 146.75, 146.50, 146.25, 146.00,
            145.75, 145.50, 145.25, 145.00, 144.75, 144.50, 144.25, 144.00, 143.75, 143.50, 143.25,
            143.00, 143.05, 143.10, 143.15, 143.20, 143.25, 143.30, 143.35, 143.40, 143.45, 143.50,
            143.55, 143.60, 143.65, 143.70, 143.75, 143.80, 143.85, 143.90, 143.95, 144.00, 142.20,
            140.40, 138.60, 136.80, 135.00, 133.20, 131.40, 129.60, 127.80, 126.00, 124.20, 122.40,
            120.60, 118.80, 117.00, 115.20, 113.40, 111.60, 109.80, 108.00, 103.50, 99.00, 94.50,
            90.00, 85.50, 81.00, 76.50, 72.00, 67.50, 63.00, 58.50, 54.00, 49.50, 45.00, 40.50,
            36.00, 31.50, 27.00, 22.50, 18.00, 17.10, 16.20, 15.30, 14.40, 13.50, 12.60, 11.70,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 16.25, 19.10, 21.95, 24.80, 27.65, 30.50, 33.35, 36.20, 39.05, 41.90, 44.75,
            47.60, 50.45, 53.30, 56.15, 59.00, 63.75, 68.50, 73.25, 78.00, 82.75, 87.50, 92.25,
            97.00, 101.75, 106.50, 111.25, 116.00, 120.75, 125.50, 130.25, 135.00, 139.75, 144.50,
            149.25, 154.00, 155.10, 156.20, 157.30, 158.40, 159.50, 160.60, 161.70, 162.80, 163.90,
            165.00, 166.10, 167.20, 168.30, 169.40, 170.50, 171.60, 172.70, 173.80, 174.90, 176.00,
            175.35, 174.70, 174.05, 173.40, 172.75, 172.10, 171.45, 170.80, 170.15, 169.50, 168.85,
            168.20, 167.55, 166.90, 166.25, 165.60, 164.95, 164.30, 163.65, 163.00, 162.95, 162.90,
            162.85, 162.80, 162.75, 162.70, 162.65, 162.60, 162.55, 162.50, 162.45, 162.40, 162.35,
            162.30, 162.25, 162.20, 162.15, 162.10, 162.05, 162.00, 163.25, 164.50, 165.75, 167.00,
            168.25, 169.50, 170.75, 172.00, 173.25, 174.50, 175.75, 177.00, 178.25, 179.50, 180.75,
            182.00, 183.25, 184.50, 185.75, 187.00, 193.80, 200.60, 207.40, 214.20, 221.00, 227.80,
            234.60, 241.40, 248.20, 255.00, 261.80, 268.60, 275.40, 282.20, 289.00, 295.80, 302.60,
            309.40, 316.20, 323.00, 328.60, 334.20, 339.80, 345.40, 351.00, 356.60, 362.20, 367.80,
            373.40, 379.00, 384.60, 390.20, 395.80, 401.40, 407.00, 412.60, 418.20, 423.80, 429.40,
            435.00, 434.40, 433.80, 433.20, 432.60, 432.00, 431.40, 430.80, 430.20, 429.60, 429.00,
            428.40, 427.80, 427.20, 426.60, 426.00, 425.40, 424.80, 424.20, 423.60, 423.00, 420.45,
            417.90, 415.35, 412.80, 410.25, 407.70, 405.15, 402.60, 400.05, 397.50, 394.95, 392.40,
            389.85, 387.30, 384.75, 382.20, 379.65, 377.10, 374.55, 372.00, 368.75, 365.50, 362.25,
            359.00, 355.75, 352.50, 349.25, 346.00, 342.75, 339.50, 336.25, 333.00, 329.75, 326.50,
            323.25, 320.00, 316.75, 313.50, 310.25, 307.00, 302.20, 297.40, 292.60, 287.80, 283.00,
            278.20, 273.40, 268.60, 263.80, 259.00, 254.20, 249.40, 244.60, 239.80, 235.00, 230.20,
            225.40, 220.60, 215.80, 211.00, 205.15, 199.30, 193.45, 187.60, 181.75, 175.90, 170.05,
            164.20, 158.35, 152.50, 146.65, 140.80, 134.95, 129.10, 123.25, 117.40, 111.55, 105.70,
            99.85, 94.00, 89.85, 85.70, 81.55, 77.40, 73.25, 69.10, 64.95, 60.80, 56.65, 52.50,
            48.35, 44.20, 40.05, 35.90, 31.75, 27.60, 23.45, 19.30, 15.15, 11.00, 10.45, 9.90,
            9.35, 8.80, 8.25, 7.70, 7.15, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00,
        ];
        let direct_normal_rad = [
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 8.80, 11.00, 13.20, 15.40, 17.60, 19.80, 22.00, 24.20, 26.40, 28.60, 30.80,
            33.00, 35.20, 37.40, 39.60, 41.80, 44.00, 57.25, 70.50, 83.75, 97.00, 110.25, 123.50,
            136.75, 150.00, 163.25, 176.50, 189.75, 203.00, 216.25, 229.50, 242.75, 256.00, 269.25,
            282.50, 295.75, 309.00, 323.55, 338.10, 352.65, 367.20, 381.75, 396.30, 410.85, 425.40,
            439.95, 454.50, 469.05, 483.60, 498.15, 512.70, 527.25, 541.80, 556.35, 570.90, 585.45,
            600.00, 607.80, 615.60, 623.40, 631.20, 639.00, 646.80, 654.60, 662.40, 670.20, 678.00,
            685.80, 693.60, 701.40, 709.20, 717.00, 724.80, 732.60, 740.40, 748.20, 756.00, 761.75,
            767.50, 773.25, 779.00, 784.75, 790.50, 796.25, 802.00, 807.75, 813.50, 819.25, 825.00,
            830.75, 836.50, 842.25, 848.00, 853.75, 859.50, 865.25, 871.00, 875.70, 880.40, 885.10,
            889.80, 894.50, 899.20, 903.90, 908.60, 913.30, 918.00, 922.70, 927.40, 932.10, 936.80,
            941.50, 946.20, 950.90, 955.60, 960.30, 965.00, 965.15, 965.30, 965.45, 965.60, 965.75,
            965.90, 966.05, 966.20, 966.35, 966.50, 966.65, 966.80, 966.95, 967.10, 967.25, 967.40,
            967.55, 967.70, 967.85, 968.00, 967.55, 967.10, 966.65, 966.20, 965.75, 965.30, 964.85,
            964.40, 963.95, 963.50, 963.05, 962.60, 962.15, 961.70, 961.25, 960.80, 960.35, 959.90,
            959.45, 959.00, 956.35, 953.70, 951.05, 948.40, 945.75, 943.10, 940.45, 937.80, 935.15,
            932.50, 929.85, 927.20, 924.55, 921.90, 919.25, 916.60, 913.95, 911.30, 908.65, 906.00,
            904.05, 902.10, 900.15, 898.20, 896.25, 894.30, 892.35, 890.40, 888.45, 886.50, 884.55,
            882.60, 880.65, 878.70, 876.75, 874.80, 872.85, 870.90, 868.95, 867.00, 860.55, 854.10,
            847.65, 841.20, 834.75, 828.30, 821.85, 815.40, 808.95, 802.50, 796.05, 789.60, 783.15,
            776.70, 770.25, 763.80, 757.35, 750.90, 744.45, 738.00, 727.95, 717.90, 707.85, 697.80,
            687.75, 677.70, 667.65, 657.60, 647.55, 637.50, 627.45, 617.40, 607.35, 597.30, 587.25,
            577.20, 567.15, 557.10, 547.05, 537.00, 518.90, 500.80, 482.70, 464.60, 446.50, 428.40,
            410.30, 392.20, 374.10, 356.00, 337.90, 319.80, 301.70, 283.60, 265.50, 247.40, 229.30,
            211.20, 193.10, 175.00, 166.25, 157.50, 148.75, 140.00, 131.25, 122.50, 113.75, 105.00,
            96.25, 87.50, 78.75, 70.00, 61.25, 52.50, 43.75, 35.00, 26.25, 17.50, 8.75, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 8.20, 10.25, 12.30, 14.35, 16.40, 18.45, 20.50,
            22.55, 24.60, 26.65, 28.70, 30.75, 32.80, 34.85, 36.90, 38.95, 41.00, 54.15, 67.30,
            80.45, 93.60, 106.75, 119.90, 133.05, 146.20, 159.35, 172.50, 185.65, 198.80, 211.95,
            225.10, 238.25, 251.40, 264.55, 277.70, 290.85, 304.00, 319.05, 334.10, 349.15, 364.20,
            379.25, 394.30, 409.35, 424.40, 439.45, 454.50, 469.55, 484.60, 499.65, 514.70, 529.75,
            544.80, 559.85, 574.90, 589.95, 605.00, 614.40, 623.80, 633.20, 642.60, 652.00, 661.40,
            670.80, 680.20, 689.60, 699.00, 708.40, 717.80, 727.20, 736.60, 746.00, 755.40, 764.80,
            774.20, 783.60, 793.00, 796.40, 799.80, 803.20, 806.60, 810.00, 813.40, 816.80, 820.20,
            823.60, 827.00, 830.40, 833.80, 837.20, 840.60, 844.00, 847.40, 850.80, 854.20, 857.60,
            861.00, 864.95, 868.90, 872.85, 876.80, 880.75, 884.70, 888.65, 892.60, 896.55, 900.50,
            904.45, 908.40, 912.35, 916.30, 920.25, 924.20, 928.15, 932.10, 936.05, 940.00, 940.30,
            940.60, 940.90, 941.20, 941.50, 941.80, 942.10, 942.40, 942.70, 943.00, 943.30, 943.60,
            943.90, 944.20, 944.50, 944.80, 945.10, 945.40, 945.70, 946.00, 945.70, 945.40, 945.10,
            944.80, 944.50, 944.20, 943.90, 943.60, 943.30, 943.00, 942.70, 942.40, 942.10, 941.80,
            941.50, 941.20, 940.90, 940.60, 940.30, 940.00, 939.55, 939.10, 938.65, 938.20, 937.75,
            937.30, 936.85, 936.40, 935.95, 935.50, 935.05, 934.60, 934.15, 933.70, 933.25, 932.80,
            932.35, 931.90, 931.45, 931.00, 927.40, 923.80, 920.20, 916.60, 913.00, 909.40, 905.80,
            902.20, 898.60, 895.00, 891.40, 887.80, 884.20, 880.60, 877.00, 873.40, 869.80, 866.20,
            862.60, 859.00, 853.75, 848.50, 843.25, 838.00, 832.75, 827.50, 822.25, 817.00, 811.75,
            806.50, 801.25, 796.00, 790.75, 785.50, 780.25, 775.00, 769.75, 764.50, 759.25, 754.00,
            743.15, 732.30, 721.45, 710.60, 699.75, 688.90, 678.05, 667.20, 656.35, 645.50, 634.65,
            623.80, 612.95, 602.10, 591.25, 580.40, 569.55, 558.70, 547.85, 537.00, 520.60, 504.20,
            487.80, 471.40, 455.00, 438.60, 422.20, 405.80, 389.40, 373.00, 356.60, 340.20, 323.80,
            307.40, 291.00, 274.60, 258.20, 241.80, 225.40, 209.00, 198.55, 188.10, 177.65, 167.20,
            156.75, 146.30, 135.85, 125.40, 114.95, 104.50, 94.05, 83.60, 73.15, 62.70, 52.25,
            41.80, 31.35, 20.90, 10.45, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 9.75,
            11.70, 13.65, 15.60, 17.55, 19.50, 21.45, 23.40, 25.35, 27.30, 29.25, 31.20, 33.15,
            35.10, 37.05, 39.00, 52.00, 65.00, 78.00, 91.00, 104.00, 117.00, 130.00, 143.00,
            156.00, 169.00, 182.00, 195.00, 208.00, 221.00, 234.00, 247.00, 260.00, 273.00, 286.00,
            299.00, 313.60, 328.20, 342.80, 357.40, 372.00, 386.60, 401.20, 415.80, 430.40, 445.00,
            459.60, 474.20, 488.80, 503.40, 518.00, 532.60, 547.20, 561.80, 576.40, 591.00, 600.60,
            610.20, 619.80, 629.40, 639.00, 648.60, 658.20, 667.80, 677.40, 687.00, 696.60, 706.20,
            715.80, 725.40, 735.00, 744.60, 754.20, 763.80, 773.40, 783.00, 787.40, 791.80, 796.20,
            800.60, 805.00, 809.40, 813.80, 818.20, 822.60, 827.00, 831.40, 835.80, 840.20, 844.60,
            849.00, 853.40, 857.80, 862.20, 866.60, 871.00, 871.10, 871.20, 871.30, 871.40, 871.50,
            871.60, 871.70, 871.80, 871.90, 872.00, 872.10, 872.20, 872.30, 872.40, 872.50, 872.60,
            872.70, 872.80, 872.90, 873.00, 865.10, 857.20, 849.30, 841.40, 833.50, 825.60, 817.70,
            809.80, 801.90, 794.00, 786.10, 778.20, 770.30, 762.40, 754.50, 746.60, 738.70, 730.80,
            722.90, 715.00, 704.85, 694.70, 684.55, 674.40, 664.25, 654.10, 643.95, 633.80, 623.65,
            613.50, 603.35, 593.20, 583.05, 572.90, 562.75, 552.60, 542.45, 532.30, 522.15, 512.00,
            506.35, 500.70, 495.05, 489.40, 483.75, 478.10, 472.45, 466.80, 461.15, 455.50, 449.85,
            444.20, 438.55, 432.90, 427.25, 421.60, 415.95, 410.30, 404.65, 399.00, 392.25, 385.50,
            378.75, 372.00, 365.25, 358.50, 351.75, 345.00, 338.25, 331.50, 324.75, 318.00, 311.25,
            304.50, 297.75, 291.00, 284.25, 277.50, 270.75, 264.00, 254.80, 245.60, 236.40, 227.20,
            218.00, 208.80, 199.60, 190.40, 181.20, 172.00, 162.80, 153.60, 144.40, 135.20, 126.00,
            116.80, 107.60, 98.40, 89.20, 80.00, 77.45, 74.90, 72.35, 69.80, 67.25, 64.70, 62.15,
            59.60, 57.05, 54.50, 51.95, 49.40, 46.85, 44.30, 41.75, 39.20, 36.65, 34.10, 31.55,
            29.00, 27.55, 26.10, 24.65, 23.20, 21.75, 20.30, 18.85, 17.40, 15.95, 14.50, 13.05,
            11.60, 10.15, 8.70, 7.25, 5.80, 4.35, 2.90, 1.45, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
            0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
        ];

        let surface_area = 20. * 3.;
        let zone_volume = 600.;

        let (simple_model, mut state_header) = get_single_zone_test_building(
            // &mut state,
            &SingleZoneTestBuildingOptions {
                zone_volume,
                surface_area,
                material_is_massive: Some(true),
                ..Default::default()
            },
        );

        // Finished model the SimpleModel

        let n: usize = 20;
        // let main_dt = 60. * 60. / n as Float;
        let solar_model = SolarModel::new(&simple_model, &mut state_header, n).unwrap();
        let mut state = state_header.take_values().unwrap();
        let mut date = Date {
            month: 1,
            day: 1,
            hour: 0.5,
        };
        for (i, exp_radiation) in incident_solar_radiation.iter().enumerate() {
            // Set outdoor temp
            let mut weather = SyntheticWeather::new();
            weather.direct_normal_radiation = Box::new(ScheduleConstant::new(direct_normal_rad[i]));
            weather.diffuse_horizontal_radiation =
                Box::new(ScheduleConstant::new(diffuse_horizontal_rad[i]));
            weather.dew_point_temperature = Box::new(ScheduleConstant::new(11.));

            let surface = &simple_model.surfaces[0];

            // March
            solar_model
                .march(date, &weather, &simple_model, &mut state)
                .unwrap();

            let front_radiation = surface.front_incident_solar_irradiance(&state).unwrap();
            // let back_radiation = surface.back_incident_solar_irradiance(&state).unwrap();

            let lat = -33.38 * PI / 180.;
            let lon = 70.78 * PI / 180.;
            let std_mer = 60. * PI / 180.;

            let solar = Solar::new(lat, lon, std_mer);
            let day = Time::Standard(date.day_of_year());
            let cos = match solar.sun_position(day) {
                Some(pos) => pos * solar_model.surfaces[0].normal,
                None => 0.,
            };

            // ignore warmup period
            println!("{},{},{}", front_radiation, exp_radiation, cos);
            // assert!( (found_radiation-exp_radiation).abs() < 0.4, "found_temp = {}, exp_temp = {} ,  error = {}", found_radiation, exp_radiation, (found_radiation - *exp_radiation).abs() );

            // Advance
            date.add_hours(1. / n as Float);
            // assert!(false)
        }
    }
}
